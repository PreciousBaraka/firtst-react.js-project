generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id           String   @id @default(uuid())
  fullName     String
  email        String   @unique
  phoneNumber  String
  password     String
  type         UserType @default(PATIENT)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  isActive     Boolean  @default(true)
  doctor       Doctor?
  patient      Patient?

  @@map("users")
}

model Doctor {
  id              String                 @default(uuid())
  userId          String                 @unique
  user            User                   @relation(fields: [userId], references: [id])
  role            Role                   @relation(fields: [roleId], references: [id])
  roleId          String
  nationalIdNo String   @unique
  specialization  SpecializationType
  specializations DoctorSpecialization[] // Add this line

  @@index([id])
  @@map("doctors")
}

model Patient {
  id     String @id @default(uuid())
  userId String @unique
  age    Int
  nationalIdNo String   @unique
  user   User   @relation(fields: [userId], references: [id])
@@index([id])
@@map("patients")
}

model Role {
  id          String   @id @default(uuid())
  name        RoleType @unique @default(NORMAL)
  description String
  doctor      Doctor[]

  @@index([id])
  @@map("roles")
}

model Specialization {
  id      String                 @id @default(uuid())
  name    String                 @unique
  doctors DoctorSpecialization[]

  @@map("specializations")
}

model DoctorSpecialization {
  doctorId         String
  specializationId String

  doctor         Doctor         @relation(fields: [doctorId], references: [userId])
  specialization Specialization @relation(fields: [specializationId], references: [id])

  @@id([doctorId, specializationId])
  @@map("doctor_specializations")
}

enum SpecializationType {
  GENERAL_SURGERY
  NEUROSURGERY
  ORTHOPEDIC_SURGERY
  CARDIOTHORACIC_SURGERY
  VASCULAR_SURGERY
  PEDIATRIC_SURGERY
  ENT_SURGERY
  OPHTHALMIC_SURGERY
  PLASTIC_SURGERY
  UROLOGIC_SURGERY
  TRAUMA_SURGERY
  COLORECTAL_SURGERY
  GYNECOLOGIC_SURGERY
}

enum RoleType {
  NORMAL
  MANAGER
}

enum UserType {
  DOCTOR
  PATIENT
}
